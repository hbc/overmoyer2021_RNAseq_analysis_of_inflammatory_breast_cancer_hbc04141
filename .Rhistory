rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(counts_post) <- c("ensembl_gene_id", "post_expression_mean_tpm")
counts_post <- counts_post %>% left_join(counts_pre, by = c("ensembl_gene_id" = "ensembl_gene_id"))
counts_post$post_expression_mean_tpm <- round(counts_post$post_expression_mean_tpm, 2)
counts_post$pre_expression_mean_tpm <- round(counts_post$pre_expression_mean_tpm, 2)
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_post, by = c("gene" = "ensembl_gene_id"))
write_xlsx(list(T1.res_pCR = res_pCR,
T2.res_pCR_post = res_pCR_post,
T3.res_nonpCR_post = res_nonpCR_post,
T4.res_pCR_diff = res_pCR_diff),
path = "tables/paired_test.xlsx")
samples_no <- meta %>% dplyr::filter(response == "non-pCR") %>% row.names()
counts_no <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples_no)) %>%
rowSums() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(counts_no) <- c("ensembl_gene_id", "non-pCR_expression_mean_tpm")
samples_yes <- meta %>% dplyr::filter(response == "pCR") %>% row.names()
counts_yes <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples_yes)) %>%
rowSums() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(counts_yes) <- c("ensembl_gene_id", "pCR_expression_mean_tpm")
counts_yes <-counts_yes %>%
left_join(counts_no,
by = c("ensembl_gene_id" = "ensembl_gene_id"))
counts_yes$pCR_expression_mean_tpm <- round(counts_yes$pCR_expression_mean_tpm, 2)
counts_yes$`non-pCR_expression_mean_tpm` <- round(counts_yes$`non-pCR_expression_mean_tpm`, 2)
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id"))
write_xlsx(list(T1.res_pCR = res_pCR,
T2.res_pCR_post = res_pCR_post,
T3.res_nonpCR_post = res_nonpCR_post,
T4.res_pCR_diff = res_pCR_diff),
path = "tables/paired_test.xlsx")
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2))
write_xlsx(list(T1.res_pCR = res_pCR,
T2.res_pCR_post = res_pCR_post,
T3.res_nonpCR_post = res_nonpCR_post,
T4.res_pCR_diff = res_pCR_diff),
path = "tables/paired_test.xlsx")
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE))
View(res_pCR_post)
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = round(format(pvalue, scientific = TRUE),2))
?format
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2))
View(res_pCR_post)
# 1425
res_pCR <- results(dds, name = "responsepCR") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 2424
res_nonpCR_post <- results(dds, name = "responsenon.pCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 23
res_pCR_diff <- results(dds, contrast = list("responsepCR.treatmentpost", "responsenon.pCR.treatmentpost")) %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 23
res_pCR_diff <- results(dds, contrast = list("responsepCR.treatmentpost", "responsenon.pCR.treatmentpost")) %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
write_xlsx(list(T1.res_pCR = res_pCR,
T2.res_pCR_post = res_pCR_post,
T3.res_nonpCR_post = res_nonpCR_post,
T4.res_pCR_diff = res_pCR_diff),
path = "tables/paired_test.xlsx")
intersect(res_pCR_post$gene, res_pCR$gene) %>% length()
intersect(res_pCR_post$gene, res_pCR$gene) %>% head()
meta$response
d <- plotCounts(dds,
gene = "ENSG00000130234",
intgroup = "treatment",
returnData = TRUE)
d <- plotCounts(dds,
gene = "ENSG00000006634",
intgroup = "treatment",
returnData = TRUE)
ggplot(d, aes(x = treatment, y = count, color = treatment)) +
geom_point(position = position_jitter(w = 0.1, h = 0)) +
geom_text_repel(aes(label = rownames(d))) +
theme_bw(base_size = 10) +
ggtitle("ACE2") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_y_log10()
d <- plotCounts(dds,
gene = "ENSG00000006634",
intgroup = "response",
returnData = TRUE)
ggplot(d, aes(x = response, y = count, color = response)) +
geom_point(position = position_jitter(w = 0.1, h = 0)) +
geom_text_repel(aes(label = rownames(d))) +
theme_bw(base_size = 10) +
ggtitle("ACE2") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_y_log10()
meta
nrow(meta)
head(meta)
samples_npCR_day1 <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
samples_npCR_pre <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
samples_npCR_pre
test <- txi$abundance
View(test)
test["ENSG00000006634",]
# Get results for treatment
resultsNames(dds)
samples_npCR_pre <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
samples_npCR_pre <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
counts_no <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples_npCR_pre)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(counts_no) <- c("ensembl_gene_id", "non-pCR_pre_mean_tpm")
counts_npCR_pre <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples_npCR_pre)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(counts_npCR_pre) <- c("ensembl_gene_id", "non-pCR_pre_mean_tpm")
View(counts_npCR_pre)
counts_npCR_pre$`non-pCR_pre_mean_tpm` <- round(counts_npCR_pre$`non-pCR_pre_mean_tpm`, 2)
View(counts_npCR_pre)
column_name <- "non-pCR_pre_mean_tpm"
samples_npCR_pre <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
samples <- samples_npCR_pre
samples
tpm_counts <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(tpm_counts) <- c("ensembl_gene_id", column_name)
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(!!column_name))
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(!column_name))
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(!!column_name, 2))
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(!column_name, 2))
tpm_counts <- tpm_counts %>% dplyr::mutate (!!column_name := round(!!column_name, 2))
tpm_counts <- tpm_counts %>% dplyr::mutate (!!column_name := round(non-pCR_pre_mean_tpm, 2))
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(non-pCR_pre_mean_tpm, 2))
tpm_counts <- tpm_counts %>% dplyr::mutate (column_name := round(`non-pCR_pre_mean_tpm`, 2))
View(tpm_counts)
tpm_counts <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
tpm_counts <- tpm_counts %>% dplyr::mutate("{column_name}" := round(`non-pCR_pre_mean_tpm`, 2))
colnames(tpm_counts) <- c("ensembl_gene_id", column_name)
tpm_counts <- tpm_counts %>% dplyr::mutate("{column_name}" := round(`non-pCR_pre_mean_tpm`, 2))
View(tpm_counts)
tpm_counts <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(tpm_counts) <- c("ensembl_gene_id", column_name)
tpm_counts <- tpm_counts %>% dplyr::mutate("{column_name}" := round("{column_name}", 2))
tpm_counts <- tpm_counts %>% dplyr::mutate("{column_name}" := round(column_name, 2))
tpm_counts <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(tpm_counts) <- c("ensembl_gene_id", "tpm")
tpm_counts <- tpm_counts %>%
dplyr::mutate("{column_name}" := round(tpm, 2)) %>%
dplyr::select(-tpm)
get_counts_for_samples <- function(samples, column_name){
tpm_counts <- txi$abundance %>%
as.data.frame() %>%
dplyr::select(any_of(samples)) %>%
rowMeans() %>%
as.data.frame() %>%
rownames_to_column(var = "ensembl_gene_id")
colnames(tpm_counts) <- c("ensembl_gene_id", "tpm")
tpm_counts <- tpm_counts %>%
dplyr::mutate("{column_name}" := round(tpm, 2)) %>%
dplyr::select(-tpm)
return(tpm_counts)
}
samples_npCR_pre <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "pre") %>% row.names()
tpm_npCR_pre <- get_counts_for_samples(samples_npCR_pre, "non-pCR_pre_mean_tpm" )
View(tpm_npCR_pre)
tpm_counts <- tpm_npCR_pre %>%
left_join(tpm_npCR_post,
by = c("ensembl_gene_id" = "ensembl_gene_id"))
tpm_npCR_post <- get_counts_for_samples(samples_npCR_post, "non-pCR_post_mean_tpm" )
samples_npCR_post <- meta %>% dplyr::filter(response == "pCR" &
treatment == "post") %>%
row.names()
tpm_npCR_post <- get_counts_for_samples(samples_npCR_post, "non-pCR_post_mean_tpm" )
tpm_counts <- tpm_npCR_pre %>%
left_join(tpm_npCR_post,
by = c("ensembl_gene_id" = "ensembl_gene_id"))
samples_npCR_post <- meta %>% dplyr::filter(response == "non-pCR" &
treatment == "post") %>%
row.names()
tpm_npCR_post <- get_counts_for_samples(samples_npCR_post, "non-pCR_post_mean_tpm" )
tpm_counts <- tpm_npCR_pre %>%
left_join(tpm_npCR_post,
by = c("ensembl_gene_id" = "ensembl_gene_id"))
samples_pCR_pre <- meta %>% dplyr::filter(response == "pCR" &
treatment == "pre") %>%
row.names()
tpm_pCR_pre <- get_counts_for_samples(samples_pCR_pre, "pCR_pre_mean_tpm" )
samples_pCR_post <- meta %>% dplyr::filter(response == "pCR" &
treatment == "post") %>%
row.names()
tpm_pCR_post <- get_counts_for_samples(samples_pCR_post, "pCR_post_mean_tpm" )
tpm_counts <- tpm_counts %>%
left_join(tpm_pCR_pre,
by = c("ensembl_gene_id" = "ensembl_gene_id")) %>%
left_join(tpm_pCR_post,
by = c("ensembl_gene_id" = "ensembl_gene_id"))
# 1425
res_pCR <- results(dds, name = "responsepCR") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(counts_yes, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 1425
res_pCR <- results(dds, name = "responsepCR") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 2424
res_nonpCR_post <- results(dds, name = "responsenon.pCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# 23
res_pCR_diff <- results(dds, contrast = list("responsepCR.treatmentpost", "responsenon.pCR.treatmentpost")) %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
write_xlsx(list(T1.res_pCR = res_pCR,
T2.res_pCR_post = res_pCR_post,
T3.res_nonpCR_post = res_nonpCR_post,
T4.res_pCR_diff = res_pCR_diff),
path = "tables/paired_test.xlsx")
length(intersect(res_pCR_post$gene, res_nonpCR_post$gene))
head(intersect(res_pCR_post$gene, res_nonpCR_post$gene)
)
# 1425
res_pCR <- results(dds, name = "responsepCR") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
comb_de_result_table()
# get rid of
comb_de_result_table <- function(results){
results <- results %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
return(results)
}
# 1425
res_pCR <- results(dds, name = "responsepCR") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id")) %>%
comb_de_result_table()
View(res_pCR)
library(VariantAnnotation)
?VcfFile
??VcfFile
getwd()
# Add a column for significant genes
res_pCR_post <- res_pCR_post %>% mutate(threshold = padj < 0.01)
## Volcano plot
ggplot(res_pCR_post) +
geom_point(aes(x = log2FoldChange, y = -log10(padj), colour = threshold)) +
ggtitle("Treatment Post vs Pre") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_x_continuous(limits = c(-10,10)) +
scale_y_continuous(limits = c(0, 2.5)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
## Volcano plot
ggplot(res_pCR_post) +
geom_point(aes(x = log2FoldChange, y = -log10(padj), colour = threshold)) +
ggtitle("pCR post") +
xlab("log2 fold change") +
ylab("-log10 adjusted p-value") +
scale_x_continuous(limits = c(-10,10)) +
scale_y_continuous(limits = c(0, 2.5)) +
theme(legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25)))
View(res_pCR_post)
res_pCR_post$log2FoldChange
res_pCR_post$padj
-log10(res_pCR_post$padj)
# 2320
res_pCR_post <- results(dds, name = "responsepCR.treatmentpost") %>%
as.data.frame() %>%
rownames_to_column(var = "gene") %>%
as_tibble() %>%
left_join(gene_symbol, by = c("gene" = "gene_id")) %>%
dplyr::filter(padj < 0.05) %>%
left_join(tpm_counts, by = c("gene" = "ensembl_gene_id"))
# for excel we need strings, for volcano - numbers
re_pCR_post_xls <- res_pCR_post %>%
mutate(baseMean = round(baseMean, 2),
log2FoldChange = round(log2FoldChange, 2),
lfcSE = round(lfcSE, 2),
stat = round(stat, 2),
pvalue = format(pvalue, scientific = TRUE, digits = 2),
padj = format(padj, scientific = TRUE, digits = 2))
# Separate into up and down-regulated gene sets
sig_pCR_post_up <- rownames(res_pCR_post)[which(res_pCR_post$padj < 0.01 &
res_pCR_post$log2FoldChange > 0)]
sig_pCR_post_down <- rownames(res_pCR_post)[which(res_pCR_post$padj < 0.01 &
res_pCR_post$log2FoldChange < 0)]
d <- plotCounts(dds,
gene = "ENSG00000006634",
intgroup = "responsepCR.treatmentpost",
returnData = TRUE)
colData(dds)
